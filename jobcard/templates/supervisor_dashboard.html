<h2 class="page-title">Supervisor Live Dashboard â€” {{ today }}</h2>

{% for key, data in dashboard_data.items %}
<div class="line-card">
  <h3 class="line-title">{{ key|upper }}</h3>
  <div class="wrapper">
    <table>
      <tr>
        <th>Operator</th>
        {% for i in hour_range %}<th>H{{i}}</th>{% endfor %}
        <th>Total</th>
      </tr>
      {% for s in data.submissions %}
      <tr>
        <td class="operator">{{ s.operator.username if s.operator else "Anonymous" }}</td>
        <td>{{s.hour1}}</td><td>{{s.hour2}}</td><td>{{s.hour3}}</td>
        <td>{{s.hour4}}</td><td>{{s.hour5}}</td><td>{{s.hour6}}</td>
        <td>{{s.hour7}}</td><td>{{s.hour8}}</td><td>{{s.hour9}}</td>
        <td>{{s.hour10}}</td><td>{{s.hour11}}</td>
        <td class="total-value">{{ s.total_output }}</td>
      </tr>
      {% endfor %}
      <tr class="total-row">
        <td>Total</td>
        {% for val in data.hour_totals %}<td>{{val}}</td>{% endfor %}
        <td>{{ data.total }}</td>
      </tr>
    </table>
  </div>
</div>
{% endfor %}

<script>
setInterval(()=>{
  fetch(window.location.href)
    .then(res=>res.text())
    .then(html=>{
      const parser = new DOMParser();
      const doc = parser.parseFromString(html, "text/html");
      document.body.innerHTML = doc.body.innerHTML;
    });
}, 3000);
</script>
